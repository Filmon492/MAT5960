\section{Numerical Method}
\subsection{Finite Volume Scheme for a General \texorpdfstring{$f$}{f}}
Designing a finite difference method typically consists of four steps:
\begin{enumerate}
    \item Discretizing the domain,
    \item Satisfying the equation at discrete points,
    \item Replacing derivatives by finite differences,
    \item Solving the discretized problem.
\end{enumerate}

However, step 3 requires that solutions are sufficiently smooth, but solutions of conservation laws may not be differentiable or even continuous. In addition, the unknown solution $u$ of a conservation law may represent a density (e.g., the average number of cars per $\mathrm{m}^2$), in this case step 2 is not flexible. For these reasons, we must adapt the steps above to design a suitable numerical method.

\subsection{Discretizing the Domain and Control Volumes}
For simplicity, we consider a uniform discretization of both the one-dimensional spatial domain $[x_L, x_R]$ and the temporal domain $[0, T]$.
We split the spatial domain $\Omega = [x_L, x_R]$ into $K$ smaller subdomains $\Omega^{j}$, such that
\begin{equation}
    \begin{split}
        \Omega & = \bigcup_{j=0}^{K-1} \Omega^{j}                                \\
               & = \bigcup_{j=0}^{K-1} [x_L + j\Delta x,\; x_L + (j+1)\Delta x],
    \end{split}
\end{equation}
where $\Delta x = \dfrac{x_R - x_L}{K}$.

We denote the midpoint of each $\Omega^{j}$ by
\[
    x_j = x_L + \Big(j + \tfrac{1}{2}\Big)\Delta x,\quad j = 0,\dots,K-1,
\]
and use each midpoint value to define the computational cells or control volumes:
\[
    \mathcal{C}_{j} = [x_{j-\frac{1}{2}},\, x_{j+\frac{1}{2}}),
\]
where the left interface $x_{j-\frac{1}{2}}$ and the right interface $x_{j+\frac{1}{2}}$ of $\mathcal{C}_{j}$ are given by
\[
    x_{j-\frac{1}{2}} = x_j - \tfrac{\Delta x}{2},\quad
    x_{j+\frac{1}{2}} = x_j + \tfrac{\Delta x}{2}.
\]

We have now split $\Omega$ into $K$ smaller non-overlapping subdomains called control volumes $\mathcal{C}_j$. These control volumes are essential for the finite volume method, as pointwise evaluation does not make sense.

Setting $\Delta t = \frac{T}{N}$, we also discretize the temporal domain $[0,T]$ as
\[
    0 = t^{0} < t^{1} < \dots < t^{N} = T,\quad \text{where } t^n = n\Delta t,\; n = 0,\dots,N.
\]

\subsection{Cell Averages and a Finite Volume Scheme}
As solutions of conservations laws may be discontinuous, pointwise evaluation does not make sense. Instead, at each time level $t^n$, we take cell averages:
\begin{equation}
    \begin{split}
        u(x_j, t^n) = u_{j}^{n} \approx \frac{1}{\Delta x}\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u(x,t^n) \,dx
    \end{split}
\end{equation}
Assuming now the cell averages are known at some time level $t^n$, we find the cell averages at next time level $t^{n+1}$ as follows:\\
Taking an integral of \eqref{eq:local model} over the domain $[x_{j- \frac{1}{2}}, x_{j+\frac{1}{2}}] \times [t^n, t^{n+1}] $
\begin{align*}
    \int_{t^n}^{t^{n+1}} \int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} {u_{t} \,dx \, dt}
    +\int_{t^n}^{t^{n+1}} \int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} f(u)_{x} \,dx \, dt = 0
\end{align*}

And applying the fundamental theorem of calculus yields (\textcolor{red}{Clarification is needed on why this theorem is applicable})
\begin{equation}\label{eq:fundamental theorem}
    \begin{split}
        \int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u(x, t^{n+1}) \,dx
        - \int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u(x, t^{n}) \,dx \\
        = - \int_{t^n}^{t^{n+1}} f(u(x_{j +\frac{1}{2}},t)) \,dt + \int_{t^n}^{t^{n+1}} f(u(x_{j-\frac{1}{2}},t)) \,dt
    \end{split}
\end{equation}
Defining the numerical fluxes
\begin{equation}\label{eq:numerical fluxes}
    \begin{split}
        {\bar{F}}_{j+ \frac{1}{2}} = \frac{1}{\Delta t} \int_{t^n}^{t^{n+1}} f(u(x_{j +\frac{1}{2}},t)) \,dt
    \end{split}
\end{equation}
and dividing both sides of $(10)$ by $\Delta x$, we obtain
\begin{equation} \label{eq:FVM with numerical fluxes}
    \begin{split}
        u_{j}^{n+1} = u_{j}^{n} - \frac{\Delta t}{\Delta x}( {\bar{F}}_{j+ \frac{1}{2}} -{\bar{F}}_{j- \frac{1}{2}})
    \end{split}
\end{equation}
Note that the relation in \eqref{eq:FVM with numerical fluxes} is not explicit, since $\bar{F}$ requires a priori knowledge of the exact solution. By introducing an appropriate approximation of the numerical flux $\bar{F}$ by $F$, we obtain the finite volume scheme for a general flux $f$:
\begin{equation}\label{eq: FVM of general f}
    \begin{split}
        u_{j}^{n+1} = u_{j}^{n} - \frac{\Delta t}{\Delta x} (F_{j+\frac{1}{2}} - F_{j-\frac{1}{2}})
    \end{split}
\end{equation}

\subsection{Lax-Friedrichs Scheme of the Nonlocal Model}

Let the flux be defined as $f = uV$, where $V$ is the nonlocal operator given in \eqref{eq: nonlocal operator}. There are several ways to specify the nonlocal numerical fluxes. In this work, we focus on a Lax-Friedrichs scheme; see the approaches in \cite{blandin2016} and \cite{huang2024}.\\
If we now define the numerical fluxes in \eqref{eq: FVM of general f} as
\begin{equation}\label{eq:Lax-F numerical fluxes}
    \begin{split}
        F_{j-\frac{1}{2}} = \frac{1}{2} (u_{j-1}^n V_{j-1}^n + u_{j}^n V_{j}^n) + \frac{\alpha}{2} (u_{j-1}^n - u_{j}^n) \\
        F_{j+\frac{1}{2}} = \frac{1}{2} (u_{j}^n V_{j}^n + u_{j+1}^n V_{j+1}^n) + \frac{\alpha}{2} (u_{j}^n - u_{j+1}^n)
    \end{split}
\end{equation}
where $\alpha >0$ is the numerical viscosity, we establish the Lax-Friedrichs scheme designed for the nonlocal model \eqref{eq:nonlocal_model}.\\
Mark that $V_{j}^{n}$ is the approximation of of the nonlocal density $V(u)$ given by
\begin{equation}\label{eq: approximation of the convolution term}
    V_{j}^{n} = 1 - \Delta x \sum_{k=0}^{m-1} w_k u_{j+k}^{n},
\end{equation}
Where $\{ w_k \}_{k= 0}^{m-1}$ is a set of numerical quadrature weights that are used to approximate the nonlocal kernel $\omega_{\epsilon}$ and $m= \lceil \frac{\epsilon}{\Delta x} \rceil$ is the number of cells involved in $V$. \\
The numerical quadrature weights $w_k$ involved in \eqref{eq: approximation of the convolution term} can be given by \\
left endpoint
\begin{equation*}
    w_k = \omega_{\epsilon}(k\Delta x)\Delta x \text{ for $k = 0, \cdots, m-1$},
\end{equation*}
normalized left endpoint
\begin{equation*}
    w_k = \frac{\omega_{\epsilon}(k\Delta x)\Delta x}{\sum_{k=0}^{m-1} \omega_{\epsilon}(k\Delta x)\Delta x}  \text{ for $k = 0, \cdots, m-1$}
\end{equation*}
and exact quadrature
\begin{equation*}
    w_k = \int_{k\Delta x}^{min\{(k+1)\Delta x,\epsilon \}}\omega_{\epsilon}(y) \,dy \text{ for $k = 0, \cdots, m-1$}
\end{equation*}
One may ask whether the choice of numerical quadrature will result in different outcomes when implementing the Lax-Friedrichs scheme. That is, whether the scheme converges for some numerical quadrature weights but fails to converge for others.\\
This question is addressed in \cite{blandin2016} through numerical experiments and mathematical explanations. We will return to this question in the next section, but for now we consider two main aspects related to the finite volume scheme: the boundary conditions and stability.

\subsection{The Boundary Conditions}

The algorithm for solving \eqref{eq:nonlocal_model} using the The Lax-Friedrichs scheme becomes:\\
\textbf{STEP 1.} Initialize $u_{j}^{0}$ by setting:
\begin{align*}
    u_{j}^{0} = \frac{1}{\Delta x}\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u_{0}(x)\,dx, \quad \forall j \in \{0,\dots,K-1\}.
\end{align*}
\textbf{STEP 2.}   for $n = 0,\dots,N-1$, compute:
\begin{align*}
    u_{j}^{n+1} & = u_{j}^{n} - \frac{\Delta t}{\Delta x}\big(F_{j+\frac{1}{2}} - F_{j-\frac{1}{2}}\big)                                                           \\
                & = \frac{1}{2}\big(u_{j+1}^{n}V_{j+1}^{n} - u_{j-1}^{n}V_{j-1}^{n}\big) - \frac{\alpha}{2}\big(u_{j+1}^{n} + u_{j-1}^{n}\big) + \alpha u_{j}^{n}.
\end{align*}

The second step is also supposed to hold for all $j \in \{0,\dots,K-1\}$. However, for $j = 0$ we obtain:
\[
    u_{0}^{n+1} = \frac{1}{2}\big(u_{1}^{n}V_{1}^{n} - u_{-1}^{n}V_{-1}^{n}\big) - \frac{\alpha}{2}\big(u_{1}^{n} + u_{-1}^{n}\big) + \alpha u_{0}^{n},
\]
and for $j = K-1$:
\[
    u_{K-1}^{n+1} = \frac{1}{2}\big(u_{K}^{n}V_{K}^{n} - u_{K-2}^{n}V_{K-2}^{n}\big) - \frac{\alpha}{2}\big(u_{K}^{n} + u_{K-2}^{n}\big) + \alpha u_{K-1}^{n}.
\]

We observe that for $j = 0$ and $j = K-1$, the scheme involves undefined terms such as $u_{-1}, V_{-1}, u_{K},$ and $V_{K}$. Therefore, without additional information the finite volume scheme is valid only for internal nodes $j \in \{1,\dots,K-2\}$.

The above discussion indicate that specifying boundary conditions are needed in order to find the values $u_{0}^{n+1}$ and $u_{K-1}^{n+1}$.

There are several options for specifying the boundary conditions on the spatial domain $[x_L, x_R]$, but the choice depends on whether the local model \eqref{eq:local model} is posed as an initial value problem (IVP) or a boundary value problem (BVP).

\begin{itemize}
    \item \textbf{Initial Value Problem (IVP):} Artificial boundary conditions are required to handle the truncated domain $[x_L, x_R]$. Truncation is necessarily for initial value problem on the entire real line $\mathbb{R}$ as computational domain needs to be bounded.
    \item \textbf{Boundary Value Problem (BVP):} Common choices include Dirichlet, Neumann, and Periodic boundary conditions.
\end{itemize}

In this work, we focus on \textbf{artificial boundary conditions}. For a detailed discussion of the remaining types, see \textcolor{red}{Citation needed here}. In this case we set the values  $u_{0}^{n+1}$ and $u_{K-1}^{n+1}$ to
\begin{align*}
    u_{0}^{n+1} = u_{1}^{n+1} \quad \text{ and } u_{K-1}^{n+1} = u_{K-2}^{n+1}
\end{align*}
That means the complete algorithm for solving \eqref{eq:nonlocal_model} using the Lax-Friedrichs scheme becomes:\\
\textbf{STEP 1.} Initialize $u_{j}^{0}$ by setting:
\begin{align*}
    u_{j}^{0} = \frac{1}{\Delta x}\int_{x_{j-\frac{1}{2}}}^{x_{j+\frac{1}{2}}} u_{0}(x)\,dx, \quad \forall j \in \{0,\dots,K-1\}.
\end{align*}
\textbf{STEP 2.}  For $n = 0,\dots,N-1$ and $j = 0,\dots,K-1$, compute:
\begin{align*}
    u_{j}^{n+1} & = u_{j}^{n} - \frac{\Delta t}{\Delta x}\big(F_{j+\frac{1}{2}} - F_{j-\frac{1}{2}}\big)                                                           \\
                & = \frac{1}{2}\big(u_{j+1}^{n}V_{j+1}^{n} - u_{j-1}^{n}V_{j-1}^{n}\big) - \frac{\alpha}{2}\big(u_{j+1}^{n} + u_{j-1}^{n}\big) + \alpha u_{j}^{n}. \\
    \text{ set }                                                                                                                                                   \\
                & u_{0}^{n+1} = u_{0}^{n} \text{ and } u_{K-1}^{n+1} = u_{K-2}^{n}
\end{align*}
\subsection{The Stability of the Lax-Friedrichs scheme}

We must make sure that the approximation solution obtained form the Lax-Friedrichs scheme shares similar properties as the entropy solution. Since the Lax-Friedrichs scheme may devolve undesired oscillations, we must impose a condition on the parameters $\Delta x$, $\Delta t$ and $\alpha$. So, we choose the parameters such that
\begin{equation}\label{stability}
    \Delta t \leq \frac{\Delta x}{\alpha}
\end{equation}
in order to obtain stability.










